<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Eclipse Chat โ ูุณุฎู ุญุฑููโุง</title>

  <!-- Styles (replace with your chat.css) -->
  <link rel="stylesheet" href="chat.css">

  <!-- Socket.IO (server provides /socket.io/socket.io.js) -->
  <script src="/socket.io/socket.io.js"></script>

  <style> /* minimal fallback font for systems without Vazir */ 
    @font-face{font-family:Vazir;src:local('Vazir'), local('Tahoma');}
    body{font-family:Vazir, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  </style>
</head>
<body class="theme-telegram">
  <!-- Topbar -->
  <header class="topbar">
    <div class="left">
      <button id="hamburger" class="icon-btn" title="ููู">
        <!-- hamburger -->
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <h1 class="app-title">Eclipse Chat</h1>
    </div>

    <div class="center">
      <input id="globalSearch" class="search-input" placeholder="ุฌุณุชุฌู ุณุฑุน (ุขุฏ ุง ุงุณู)" aria-label="search">
    </div>

    <div class="right">
      <button id="startChatBtn" class="icon-btn" title="ูพุงู ุฌุฏุฏ">+</button>
      <select id="themeSelect" title="ุงูุชุฎุงุจ ุชู" aria-label="theme select">
        <option value="theme-telegram">ุชูฺฏุฑุงู (ูพุดโูุฑุถ)</option>
        <option value="theme-instagram">ุงูุณุชุงฺฏุฑุงู</option>
        <option value="theme-whatsapp">ูุงุชุณุงูพ</option>
        <option value="theme-future">ููฺุฑ</option>
      </select>
      <button id="openSaved" class="icon-btn" title="ูพุงูโูุง ุฐุฎุฑูโุดุฏู">โ</button>
    </div>
  </header>

  <!-- Main layout -->
  <main class="main-layout container">

    <!-- Sidebar / Conversations -->
    <aside id="sidebar" class="rounded" role="navigation">
      <div id="sidebarTop" class="sidebar-header">
        <img id="profileAvatar" class="avatar" src="/default.png" alt="avatar">
        <div class="profile-meta">
          <!-- CHANGED: myName -> profileDisplayName (chat.js expects this) -->
          <div id="profileDisplayName" data-old-id="myName" class="my-name">ฺฉุงุฑุจุฑ</div>
          <!-- CHANGED: myId -> profileUsername -->
          <div id="profileUsername" data-old-id="myId" class="my-id">@yourid</div>
        </div>
      </div>

      <div class="mb-8 p-8">
        <button id="newChatBtn" class="small-btn">+ ฺฏูุชฺฏู ุฌุฏุฏ</button>
        <button id="clearLocalBtn" class="small-btn">ูพุงฺฉุณุงุฒ ูุญู</button>
      </div>

      <!-- CONVERSATION LIST -->
      <!-- CHANGED id userList -> convList so chat.js can find it -->
      <div class="conv-list users" id="convList" data-old-id="userList" aria-live="polite"></div>

      <div style="margin-top:auto;display:flex;gap:8px;justify-content:space-between;align-items:center">
        <div class="muted small">ูุณุฎู ุทุฑุงุญโุดุฏู</div>
        <div><button id="logoutBtn" class="btn secondary">ุฎุฑูุฌ</button></div>
      </div>
    </aside>

    <!-- Chat panel -->
    <section id="chatPanel" class="chat-panel">
      <div class="chat-header">
        <div class="chat-title">
          <div id="convTitle">ุงูุชุฎุงุจ ฺฉูุฏ</div>
          <div id="convSubtitle" class="muted small">ูฺ ฺฏูุชฺฏู ุงูุชุฎุงุจ ูุดุฏู</div>
        </div>
      </div>

      <!-- MESSAGES WRAP -->
      <!-- ADDED id messageList so JS can render messages into it -->
      <div class="messages-wrap" id="messageList" aria-live="polite">
        <!-- messages will be appended here by chat.js -->
      </div>

      <!-- Composer -->
      <div class="composer">
        <!-- ADDED composerInput and sendBtn and attachmentBtn for chat.js hooks -->
        <input id="composerInput" placeholder="ูพุงู ุฎูุฏ ุฑุง ุจููุณ..." autocomplete="off" />
        <button id="attachmentBtn" class="icon-btn" title="ุถููู">๐</button>
        <button id="sendBtn" class="btn">ุงุฑุณุงู</button>
      </div>
    </section>

    <!-- RIGHT SIDEBAR / DRAWER (profile/settings) -->
    <div class="drawer" id="drawer" role="dialog" aria-hidden="true">
      <div class="tabs">
        <div class="tab active">ูพุฑููุงู</div>
        <div class="tab">ุชูุธูุงุช</div>
      </div>

      <div class="field profilePreview">
        <img id="drawerAvatar" class="avatar" src="/default.png" alt="avatar">
        <div>
          <div id="drawerName" class="muted">ฺฉุงุฑุจุฑ</div>
          <div id="drawerId" class="muted small">@yourid</div>
        </div>
      </div>

      <div class="field profile-edit">
        <label>ุงุณู ููุงุด</label>
        <input id="editDisplayName" type="text" />
        <label>ุขุฏ</label>
        <input id="editUsername" type="text" />
        <label>ุจู</label>
        <textarea id="editBio"></textarea>
        <div id="profileMsg" class="muted small"></div>
        <button id="saveProfileBtn" class="btn">ุฐุฎุฑู</button>
      </div>

      <div class="field">
        <label>ุชู</label>
        <select id="themeSelector">
          <option value="telegram">ุชูฺฏุฑุงู</option>
          <option value="neon">ูุฆูู</option>
          <option value="galaxy">ฺฏุงูฺฉุณ</option>
        </select>
      </div>

    </div>

  </main>

  <!-- TEMPLATE: message (hidden, used by JS to clone) -->
  <template id="tpl-message">
    <div class="message-item">
      <div class="message-bubble">
        <div class="message-meta">
          <span class="fromName"></span>
          <span class="atTime muted small"></span>
        </div>
        <div class="message-text"></div>
      </div>
    </div>
  </template>

  <!-- your chat.js -->
  <script src="chat.js"></script>
</body>
</html>